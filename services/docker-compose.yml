version: "3"

services:
  mqtt-broker:
    env_file:
      - .env
    build: mqtt-broker
    container_name: pot-pourri-mqtt-broker
    ports:
      - ${mqtt_broker_port}:1883
    restart: always

  datastore:
    env_file:
      - .env
    build: datastore
    volumes:
      - ./datastore/db:/app/db
    ports:
      - ${datastore_port}:3000
    restart: always

  ui:
    env_file:
      - .env
    build: ui
    ports:
      - ${ui_port}:3002
    depends_on:
      - datastore
    restart: always
    environment:
      - DATASTORE_HOSTNAME=${hostname}
      - DATASTORE_PORT=${datastore_port}
